<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>CSS114 Linear Solver</title>
    <link rel="stylesheet" href="https://pyscript.net/releases/2024.1.1/core.css" />
    <script type="module" src="https://pyscript.net/releases/2024.1.1/core.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-slate-50 min-h-screen text-slate-900">
    <main class="max-w-5xl mx-auto px-6 py-10 lg:py-14">
        <header class="flex flex-col gap-4 md:flex-row md:items-center md:justify-between">
            <div>
                <p class="text-xs uppercase tracking-[0.2em] text-blue-600 font-semibold">CSS114</p>
                <h1 class="text-3xl md:text-4xl font-bold text-slate-900">Linear Solver</h1>
                <p class="mt-2 text-sm md:text-base text-slate-600 max-w-xl">
                    Solve systems of linear equations quickly with Gauss, Gauss-Jordan, or LU decomposition. Adjust the
                    matrix size, enter coefficients, and calculate instantly.
                </p>
            </div>
            <div class="flex items-center gap-3">
                <div class="flex flex-col text-right">
                    <span class="text-xs uppercase tracking-wide text-slate-500">Status</span>
                    <span class="text-sm font-semibold text-emerald-600">Ready</span>
                </div>
                <span class="inline-flex h-10 w-10 items-center justify-center rounded-full bg-blue-100 text-blue-600 font-bold">
                    123
                </span>
            </div>
        </header>

        <section class="mt-10 grid gap-6 lg:grid-cols-[2fr,1fr]">
            <div class="bg-white rounded-3xl shadow-lg border border-slate-200 p-6 md:p-8">
                <div class="flex flex-col gap-4 md:flex-row md:items-center md:justify-between">
                    <div>
                        <h2 class="text-lg font-semibold text-slate-900">Matrix Setup</h2>
                        <p class="text-sm text-slate-500">Choose the matrix size and solving method.</p>
                    </div>
                    <div class="flex flex-wrap gap-3">
                        <button id="resetButton" class="text-sm font-semibold text-slate-500 hover:text-slate-900">Reset values</button>
                        <span class="inline-flex items-center gap-2 rounded-full bg-slate-100 px-3 py-1 text-xs font-semibold text-slate-600">
                            Auto-updates
                        </span>
                    </div>
                </div>

                <div class="mt-6 flex flex-wrap gap-4">
                    <label class="flex flex-col gap-2 text-sm font-medium text-slate-700">
                        Rows
                        <input type="number" id="rows" value="3" min="1" max="10" class="border border-slate-200 p-2 rounded-lg w-24 text-center shadow-sm focus:border-blue-500 focus:outline-none">
                    </label>
                    <label class="flex flex-col gap-2 text-sm font-medium text-slate-700">
                        Columns
                        <input type="number" id="cols" value="3" min="1" max="10" class="border border-slate-200 p-2 rounded-lg w-24 text-center shadow-sm focus:border-blue-500 focus:outline-none">
                    </label>
                    <label class="flex flex-1 min-w-[220px] flex-col gap-2 text-sm font-medium text-slate-700">
                        Method
                        <select id="method" class="border border-slate-200 p-2 rounded-lg bg-white shadow-sm cursor-pointer focus:border-blue-500 focus:outline-none">
                            <option value="gauss">Gauss Elimination with Pivoting</option>
                            <option value="jordan">Gauss-Jordan Elimination</option>
                            <option value="lu">LU Decomposition with Pivoting</option>
                            <option value="inverse">Inverse Matrix (LU with Pivoting)</option>
                        </select>
                    </label>
                </div>

                <div class="mt-6 rounded-2xl border border-dashed border-slate-200 bg-slate-50 p-4">
                    <div class="flex items-center justify-between mb-3">
                        <h3 class="text-sm font-semibold text-slate-700">Coefficient Matrix</h3>
                        <span class="text-xs text-slate-500">A · x = b</span>
                    </div>
                    <div id="matrixContainer" class="overflow-x-auto"></div>
                </div>

                <button py-click="solve_system" class="mt-6 w-full bg-blue-600 text-white font-semibold py-4 rounded-2xl hover:bg-blue-700 transition-all active:scale-[0.99] shadow-md">
                    Calculate
                </button>
            </div>

            <aside class="bg-white rounded-3xl shadow-lg border border-slate-200 p-6 md:p-8 flex flex-col gap-6">
                <div>
                    <h2 class="text-lg font-semibold text-slate-900">คำแนะนำ</h2>
                    <ul class="mt-3 space-y-2 text-sm text-slate-600">
                        <li class="flex gap-2"><span class="text-blue-500 font-semibold">1.</span> กำหนดขนาดเมทริกซ์</li>
                        <li class="flex gap-2"><span class="text-blue-500 font-semibold">2.</span> กรอกค่าสัมประสิทธิ์และค่าคงที่</li>
                        <li class="flex gap-2"><span class="text-blue-500 font-semibold">3.</span> เลือกวิธีการแก้สมการ</li>
                        <li class="flex gap-2"><span class="text-blue-500 font-semibold">4.</span> กดปุ่ม Calculate เพื่อดูผลลัพธ์</li>
                    </ul>
                </div>

                <div id="resultArea" class="hidden">
                    <h2 class="text-xs font-bold text-slate-400 uppercase tracking-widest mb-3">Solution Results</h2>
                    <div id="solutionGrid" class="grid grid-cols-2 gap-4"></div>
                    <div id="extraInfo" class="mt-4 rounded-xl bg-slate-100 p-3 text-sm text-slate-600"></div>
                    <div class="mt-4">
                        <h3 class="text-xs font-bold text-slate-400 uppercase tracking-widest mb-2">Process Steps</h3>
                        <pre id="processSteps" class="max-h-72 overflow-auto rounded-xl bg-slate-900 p-3 text-xs leading-relaxed text-slate-100 whitespace-pre-wrap"></pre>
                    </div>
                </div>
            </aside>
        </section>
    </main>

    <py-config>
        packages = ["numpy"]
    </py-config>
    <py-script src="LU.py"></py-script>

    <script>
        const rowsInput = document.getElementById("rows");
        const colsInput = document.getElementById("cols");
        const matrixContainer = document.getElementById("matrixContainer");
        const resetButton = document.getElementById("resetButton");

        const renderMatrix = () => {
            const rows = Math.max(1, Math.min(10, Number(rowsInput.value) || 1));
            const cols = Math.max(1, Math.min(10, Number(colsInput.value) || 1));
            rowsInput.value = rows;
            colsInput.value = cols;

            let html = '<div class="inline-grid gap-2">';
            for (let i = 0; i < rows; i++) {
                html += '<div class="flex items-center gap-2">';
                for (let j = 0; j < cols; j++) {
                    html += `
                        <input
                            id="a-${i}-${j}"
                            type="number"
                            step="any"
                            placeholder="0"
                            class="w-20 rounded-lg border border-slate-200 bg-white p-2 text-center text-sm shadow-sm focus:border-blue-500 focus:outline-none"
                        />`;
                }
                html += '<span class="text-slate-400 font-semibold">=</span>';
                html += `
                    <input
                        id="b-${i}"
                        type="number"
                        step="any"
                        placeholder="0"
                        class="w-20 rounded-lg border border-slate-200 bg-white p-2 text-center text-sm shadow-sm focus:border-blue-500 focus:outline-none"
                    />`;
                html += '</div>';
            }
            html += '</div>';
            matrixContainer.innerHTML = html;
        };

        const resetMatrix = () => {
            matrixContainer.querySelectorAll("input").forEach((input) => {
                input.value = "";
            });
            document.getElementById("resultArea").classList.add("hidden");
            document.getElementById("extraInfo").innerText = "";
            document.getElementById("processSteps").innerText = "";
        };

        rowsInput.addEventListener("input", renderMatrix);
        colsInput.addEventListener("input", renderMatrix);
        resetButton.addEventListener("click", resetMatrix);

        renderMatrix();
    </script>
</body>
</html>
